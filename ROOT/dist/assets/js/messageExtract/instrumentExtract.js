$(".request_address").attr("href", requestAddress + "/extractJudgment");
$(".request_address").html(requestAddress + "/extractJudgment");
var exampleList = [
  "案  由 侵害商标权纠纷  （2021）最高法民申7883号\n再审申请人(一审被告、二审上诉人)：上海东家旺建材科技有限公司。住所地上市青浦区香大东路1318号1幢6层C区6069室。\n法定代表人：姜合莲，该公司执行董事兼总经理。\n时间：2022年11月30日\n被申请人（一审原告、二审上诉人）：上海天力实业（集团）有限公司。住地：海市奉贤区金汇镇金斗路288号。\n法定代表人：郑国钦，该公司董事长。\n委托诉讼代理人：宋子轩，湖南思博达律师事务所\n一审被告、二审上诉人：长沙市芙蓉区田园塑胶经营部。经营场所：湖南省长市蓉区远大一路1579号湖南省汽车摩托车贸易有限公司张公岭仓库。\n经营者：姜胜，男，1981年9月26日出生，汉族，住浙江省江山市。\n一审被告、二审被上诉人：上海东家旺建材科技有限公司湖南分公司。经营所：南省长沙市芙蓉区火星街道马王堆新合村五村A-14栋105房。\n负责人：姜合莲。\n涉案金额：10万\n开庭法庭：第三法庭  \n再审申请人上海东家旺建材科技有限公司（以下简称东家旺公司）因与被申请上天力实业（集团）有限公司（以下简称天力公司），长沙市芙蓉区田园塑胶营（以下简称田园经营部）、上海东家旺建材科技有限公司湖南分公司（以下称东旺湖南分公司）侵害商标权纠纷一案，不服湖南省高级人民法院(2020)湘民终81号民事判决，向本院申请再审。本院受理后依法组成合议进行了审查，已审查结。",
  "被告：李志东，男，1983年12月12日出生，汉族，户籍所在地四川省。\n　　上海市青浦区人民法院于2017年11月21日作出(2017)沪0118刑初1148号刑事判决，以被告人李志东犯强制猥亵罪，判处有期徒刑一年三个月。(刑期自2017年8月26日起至2018年11月25日止。)判决发生法律效力后，罪犯李志东被交付执行。\n　　执行机关上海市北新泾监狱以沪司狱北减字(2018)第158号报请减刑建议书报请本院审理。本院于2018年10月9日受理后，依法组成合议庭进行了书面审理，并于2018年10月13日至2018年10月17日向社会和罪犯服刑场所进行了公示，公示期间未收到异议。现已审理终结。\n　　执行机关减刑建议书提出，罪犯李志东在服刑期间，确有悔改表现，符合减刑条件，建议予以减去有期徒刑余刑。\n　　上海市闵行区人民检察院出具的沪闵检执检减(假)提请意〔2018〕214号减刑(假释)提请活动检察意见书认为，罪犯李志东符合提请减刑条件。\n　　经审理查明，罪犯李志东在服刑期间，能够认罪悔罪，认真遵守法律法规及监规，接受教育改造，积极参加思想、文化、职业技术教育，积极参加劳动，努力完成生产任务，无任何违纪扣分。据此，罪犯李志东受到执行机关表扬1次奖励。\n　　以上事实，有原审刑事判决书、罪犯李志东的认罪服法书，有执行机关制作的有关李志东在服刑期间的三课教育情况统计表、劳动情况统计表、计分明细单、计分考评和行政奖惩审核表、评审鉴定表、奖惩审批表等证据证实。\n　　本院认为，罪犯李志东在服刑期间，确有悔改表现，符合法定减刑条件，可以减刑，执行机关建议减刑的意见，本院予以采纳。综合其犯罪性质和具体情节、社会危害程度、原判刑罚情况等因素，确定裁刑幅度。据此，依照《中华人民共和国刑法》第七十八条第一款、第二款第(一)项、第七十九条，《中华人民共和国刑事诉讼法》第二百六十二条第二款，《最高人民法院关于办理减刑、假释案件具体应用法律的规定》第二条、第六条第一款、第二款、第十六条及《最高人民法院关于减刑、假释案件审理程序的规定》第十六条第一款第(一)项之规定，裁定如下：\n　　对罪犯李志东减去有期徒刑一个月三日。\n　　(刑期自2017年8月26日起至2018年10月22日止。)\n　　本裁定送达后即发生法律效力。\n     审  判  长    汪  清\n     代理审判员    冯彦霄\n     人民陪审员    杨智勇\n     书  记  员    刘  昕\n       二〇一八年十月二十二日",
  "上海市崇明区人民法院\n案由：民间借贷纠纷    \n案号：（2023）沪0151民初323号\n原告：彭婉芬，女，1993年4月27日生，汉族，户籍地湖北省武汉市黄陂区。\n被告：孙伟，男，1987年3月3日生，汉族，户籍地上海市崇明区。\n原告彭婉芬与被告孙伟民间借贷纠纷一案，本院于2023年1月4日立案，依法适用简易程序审理。审理中，原告彭婉芬向本院提出撤诉申请，经查询诉讼费未缴纳。\n本院认为，原告彭婉芬自愿撤回对被告孙伟的诉讼，于法无悖，应予准许。\n依照《中华人民共和国民事诉讼法》第一百四十八条第一款规定，裁定如下：\n准许彭婉芬撤诉。\n\n     审  判  员    曲  翔\n     书  记  员    唐天伦\n       二〇二三年一月十二日",
];

$("#edit_item").val(exampleList[0]);

function pickOption() {
  var selectDom = document.querySelector(".custom-select");
  var index = selectDom.selectedIndex; //获取选中项的索引
  document.querySelector("#edit_item").value = exampleList[index - 1];
}

var edit_text = document.querySelector("#edit_item").value;
var editObj = {
  text: edit_text,
};
var resultJSON = JSON.stringify(editObj);
var result = syntaxHighlight(JSON.parse(resultJSON));
$("#result").html(result);

var dataList = [
  {
    法院: [
      {
        probability: 0.9907652674429741,
        start: 544,
        end: 553,
        text: "湖南省高级人民法院",
      },
    ],
    案由: [
      {
        probability: 0.503562037551486,
        start: 5,
        end: 12,
        text: "侵害商标权纠纷",
      },
    ],
    开庭时间: [
      {
        probability: 0.6872715517751118,
        start: 119,
        end: 130,
        text: "2022年11月30日",
      },
    ],
    法庭: [
      {
        probability: 0.8981004343488692,
        start: 414,
        end: 418,
        text: "第三法庭",
      },
    ],
    律师: [
      {
        probability: 0.33412154016258455,
        start: 209,
        end: 212,
        text: "宋子轩",
      },
    ],
    律所: [
      {
        probability: 0.6304926975028948,
        start: 213,
        end: 223,
        text: "湖南思博达律师事务所",
      },
      {
        probability: 0.3901245461948406,
        start: 544,
        end: 553,
        text: "湖南省高级人民法院",
      },
    ],
    金额: [
      { probability: 0.9287995098381252, start: 405, end: 408, text: "10万" },
    ],
    被告: [
      {
        probability: 0.44057804913187937,
        start: 49,
        end: 62,
        text: "上海东家旺建材科技有限公司",
      },
      {
        probability: 0.4825784314571564,
        start: 507,
        end: 532,
        text: "建材科技有限公司湖南分公司（以下称东旺湖南分公司）",
      },
    ],
  },
];
var strHtml = "";
var index = 0;
for (const item in dataList[0]) {
  // console.log(index);
  var text = "";
  dataList[0][item].forEach((element) => {
    text += element.text + "、";
  });
  if (text.length > 0) {
    text = text.substring(0, text.length - 1);
  }
  strHtml += ` <tr>
    <td>${++index}</td>
    <td>${item}</td>
    <td>${text}</td>
    <td>${dataList[0][item][0].probability}</td>
  </tr>`;
}
$("#analysis_list").html(strHtml);
$("#returnresult").html(syntaxHighlight(dataList));

$(".analysis_name").click(function () {
  var edit_text = filterXSS(document.querySelector("#edit_item").value.trim());
  if (edit_text) {
    var editObj = {
      text: edit_text,
    };
    var resultJSON = JSON.stringify(editObj);
    var result = syntaxHighlight(JSON.parse(resultJSON));
    $("#result").html(result);

    $("#marklayer").addClass("mark-show");

    $.ajax({
      method: "POST",
      url: baseAPI + "/extractJudgment",
      headers: {
        "secret-id": secret_id,
        "secret-key": secret_key,
      },
      contentType: "application/json",
      dataType: "json",
      data: resultJSON.replace(/\n/g, ""),
      success: function (res) {
        $("#marklayer").removeClass("mark-show");
        if (res.code == 200) {
          var resJSON = JSON.stringify(res);
          resObj = JSON.parse(resJSON);
          var returnresult = syntaxHighlight(resObj);
          $("#returnresult").html(returnresult);

          if ($(".empty-text").length > 0) {
            $(".empty-text").remove();
          }

          if (res.result.length > 0) {
            $(".table-responsive").removeClass("hide");
            $(".prompt").addClass("hide");

            // 插入分析列表数据
            var table_data = res.result[0];
            var analysis_list = "";
            var index = 0;
            for (var item in table_data) {
              var text = "";
              table_data[item].forEach((element) => {
                text += element.text + "、";
              });
              if (text.length > 0) {
                text = text.substring(0, text.length - 1);
              }
              analysis_list += `<tr>
                                  <td>${++index}</td>
                                  <td>${item}</td>
                                  <td>${text}</td>
                                  <td>${table_data[item][0].probability}</td>
                                </tr>`;
            }
            $("#analysis_list").html(analysis_list);
          } else {
            $(".prompt .card-body").append(
              `<div class="empty-text">返回结果为空，换段文本再试试吧</div>`
            );
            $(".table-responsive").addClass("hide");
            $(".prompt").removeClass("hide");
          }
        }
      },
    });
  } else {
    $(".message-error .message_content").html("请输入要抽取的内容");
    $(".message-error").removeClass("message-hide");
    setTimeout(() => {
      $(".message-error").addClass("message-hide");
    }, 2000);
  }
});
