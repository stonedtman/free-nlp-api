$(".request_address").attr("href", requestAddress + "/NER_ORG");
$(".request_address").html(requestAddress + "/NER_ORG");
var exampleList = [
  "民生银行1月20日晚间公告，民生银行北京分行以金融借款合同纠纷为由，对恒力集团有限公司、积塔半导体、泛海控股股份有限公司 及卢志强提起诉讼。借款人未按合同约定履行还款义务，泛海控股和卢志强未履行保证担保责任，期间卢志强还找过复星医药请求财政支援，但实施未果。要求判令被告偿还两笔借款本金39.72亿元和30.46亿元及相应的利息、罚息。北京市银保监会对此事会表示特别关注会发话：对这类贷款，要加强管理！",
  "在A、港、美三地IPO的中国公司，跟VC/PE亲密度大不同\n上个月，港交所刊发上市规则咨询文件征求意见稿，欲吸引无盈利、无收入科技公司赴港上市。在中概股回归浪潮下，港交所展示了足够的包容度。另外，近年来 A 股科创板、创业板以及北交所的设立，也在不断向市场释放积极信号。以上种种，给企业提供了更多选择空间。对于企业而言，如果把成功上市作为一个节点，那么近两年来走向这一节点的企业有哪些特点，而这些企业上市前在一级市场又经历了怎样的历程？这些企业走过的路对后来者是否也有一定的借鉴意义？首先来看，最近非常活跃坊间传闻拟定上市的一批独角兽公司，例如：高顿网校，微创脑科学，日日顺供应链，十月稻田，小鹏汇天，翱捷科技，创新奇智。再看近两年上市公司一级市场的融资历程，上市公司在一级市场与资本的接触各有不同，从上市公司一级市场融资次数和融资金额来看，选择A股、港股、美股上市的企业，其一级市场经历存在着一定差距。从融资次数来看，近两年选择 A股上市的公司中，有超过50%在一级市场没有公开融资；例如：北京九州一轨环境科技股份有限公司，常州迅安科技股份有限公司，四川百利天恒药业股份有限公司，安徽富乐德科技发展股份有限公司，鸿铭股份。再来看美股，3轮及以上占比近40%，5轮及以上占比已超20%。美股3轮及以上占比更是超过70%，5 轮及以上占比达到43.5%。而从公司上市前融资金额来看，A股公司上市前融资金额多集中在5亿以下，港股公司则是集中在10-50亿。近两年一级市场融资百亿以上的美股上市公司也有6家，分别为：天合光能、文思信息、药明康德、兖州煤业、三生制药、亚信科技。再看港股，近两年赴港上市的130+中国境内企业，从成立到上市所用时间较为均匀。祥生控股、北控城市资源、世茂服务等10家企业在2年内上市，占比 7.6%；之后 3-5 年、5-7 年、7-10 年占比均在10%-20%之间，分别为 15.9%、13.6%、18.2%，10 年内占比超 50%。而从 10-15 年这一跨度占比22.7%。15-20年以及20年以上占比则分别为10.6%和11.4%。相较于A股和港股，近两年赴美上市中概股，从成立到走向上市，用时就相对短了一些。据IT桔子统计，60+中概股中，虽没有在成立2年就成功上市的企业，但 3-5 年内占比 21%，5-7 年占比 32.3%，7-10 年占比 25.8%。由此，10年内占比为近 80%。",
  "内蒙古大中矿业股份有限公司助力 医院、高校疫情防控9月末疫情突发，让呼和浩特这座城市再一次按下“暂停键”。大中矿业积极履行社会责任，为重点医院及高校捐赠防疫物资。在这场疫情防控阻击战中，内蒙古医科大学第二附属医院、内蒙古自治区肿瘤医院共计800余名医护人员留守医院，家里仅剩孩子和老人。前方奋战，后方支援！分行得知情况，在各物资派送渠道紧张的情况下，整合渠道，统筹安排，仅用3天时间，完成两家医院800余名职工家属物资派送工作，做到物资消杀达标、质量达标、效率达标，获得医院一致认可和赞誉。在严峻复杂的疫情形势中，内蒙古各高校面临防疫压力大、防疫物资告急的情况。分行心系内蒙古各高校师生动态，时刻关注学校防疫需求，并在第一时间为内蒙古建筑职业技术学院、内蒙古科学技术研究院、内蒙古师范大学、内蒙古农业大学、内蒙古化工职业学院、内蒙古体育职业学院、内蒙古鸿德文理学院送去首批近20万元的防疫物资，共计n95口罩16000只、防护服1030套、防护面罩1030套、防护脚套1030套、方便面190箱、消毒液50箱，后续将持续对各高校支持45000只医用外科口罩、3000余套防疫包，用实际行动助力高校防疫工作。携手医校，同心抗“疫”。大中矿业以实际行动践行了金融机构的责任与担当，充分体现了民生银行“服务大众，情系民生”的使命，为疫情防控工作责献民生力量。",
  "截至目前,销售易凭借丰富的专业的产品能力及服务,已经在制造、软件互联网、高科技、生命科学等众多行业,获得了包含联想集团、沈鼓集团、上海电气、海康威视、施耐德电气等众多500强企业的5000+企业青睐,并获得知名风投红杉资本、戈壁资本、经纬中国以及腾讯投资的鼎力支持,成为数字经济时代的企业服务领军企业。2022年,销售易6度入选Gartner SFA全球魔力象限,仍然是中国唯一一家入选的CRM厂商,与Salesforce、Oracle、SAP、Microsoft等国际知名软件厂商同台竞技,并在可视化分析和复杂产品配置报价(CPQ)两大能力上的得分跃居全球第一,在移动端、销售机会管理、渠道销售管理能力名列三甲。销售易正代表国产CRM向全球市场证明中国制造已然崛起,而作为国产替代的深度参与者,销售易也已经成功帮助施耐德电气、华大基因、海能达等众多500强企业,完成从国际品牌到国产软件的切换,满足了企业对于CRM自主可控、安全合规的要求。",
];
$("#edit_item").val(exampleList[0]);

function pickOption() {
  var selectDom = document.querySelector(".custom-select");
  var index = selectDom.selectedIndex; //获取选中项的索引
  document.querySelector("#edit_item").value = exampleList[index - 1];
}

var comparativeData = [
  {
    IPO_CN: "国内主板上市公司",
  },
  // { IPO_HK: "港股上市公司" },
  // { IPO_USA: "美股上市公司" },
  { unicorn: "独角兽" },
  { GOV_Dept: "政府机关" },
  { invest: "投资机构" },
  { bank: "银行" },
  { fortune_CN_500: "中国500强企业" },
  { fortune_Global_500: "世界500强企业" },
  { universities: "高校大学" },
  { research_institution: "科研院所" },
  { hospital: "医院" },
  { org: "机构" },
];
var comparativeStr = "";
comparativeData.slice(0, 10).forEach((item, index) => {
  for (const key in item) {
    comparativeStr += `<tr>
          <td>${index + 1}</td>
          <td>${key}</td>
          <td>${item[key]}</td>
          </tr>`;
  }
});

$("#comparative_tab").html(comparativeStr);

layui.use("laypage", function () {
  var laypage = layui.laypage;

  //执行一个laypage实例
  laypage.render({
    elem: "compare_pagination",
    count: Object.keys(comparativeData).length,
    limit: 10,
    groups: 3,
    layout: ["count", "prev", "page", "next", "skip"],
    jump: function (obj) {
      var pageList = comparativeData.slice((obj.curr - 1) * 10, obj.curr * 10);
      var analysis_list = "";
      pageList.forEach((item, index) => {
        for (const key in item) {
          analysis_list += `<tr>
          <td>${index + 1}</td>
          <td>${key}</td>
          <td>${item[key]}</td>
          </tr>`;
        }
      });

      $("#comparative_tab").html(analysis_list);
    },
    theme: "#5369f8",
  });
});

var edit_text = document.querySelector("#edit_item").value;
var editObj = {
  text: edit_text,
};
var resultJSON = JSON.stringify(editObj);
var result = syntaxHighlight(JSON.parse(resultJSON));
$("#result").html(result); //请求示例

//原始数据
var dataList = {
  msg: "机构识别抽取成功",
  code: "200",
  results: [
    {
      count: 2,
      label: "IPO_CN",
      word: "民生银行",
    },
    {
      count: 2,
      label: "IPO_CN",
      word: "泛海控股",
    },
    {
      count: 1,
      label: "fortune_Global_500",
      word: "恒力集团有限公司",
    },
    {
      count: 1,
      label: "IPO_CN",
      word: "复星医药",
    },
  ],
};

$("#returnresult").html(syntaxHighlight(dataList)); //返回示例

function pagination(arr) {
  layui.use("laypage", function () {
    var laypage = layui.laypage;

    //执行一个laypage实例
    laypage.render({
      elem: "pagination",
      count: arr.length,
      limit: 10,
      groups: 3,
      layout: ["count", "prev", "page", "next", "skip"],
      jump: function (obj) {
        var pageList = arr.slice((obj.curr - 1) * 10, obj.curr * 10);
        // 插入分析列表数据
        var analysis_list = "";
        pageList.forEach((item, index) => {
          analysis_list += `<tr>
            <td>${index + 1}</td>
            <td>${item.label}</td>
            <td>${item.word}</td>
            <td>${item.count}</td>
            </tr>`;
        });
        //   列表应该往列表后面添加元素,直接html会直接覆盖原来的
        $("#analysis_list").html(analysis_list);
      },
      theme: "#5369f8",
    });
  });
}
pagination(dataList);

//点击事件
$(".analysis_name").click(function () {
  var edit_text = filterXSS(document.querySelector("#edit_item").value).trim();
  if (edit_text) {
    var editObj = {
      text: edit_text,
    };
    var resultJSON = JSON.stringify(editObj);
    var result = syntaxHighlight(JSON.parse(resultJSON));
    $("#result").html(result); //请求示例
    $("#marklayer").addClass("mark-show"); //加载状态
    $.ajax({
      method: "POST",
      headers: {
        "secret-id": secret_id,
        "secret-key": secret_key,
      },
      url: baseAPI + "/NER_ORG",
      contentType: "application/json",
      dataType: "json",
      data: resultJSON,
      success: function (res) {
        $("#marklayer").removeClass("mark-show");
        if (res.code == 200) {
          dataList = res;

          var resJSON = JSON.stringify(res);
          resObj = JSON.parse(resJSON);
          var returnresult = syntaxHighlight(resObj);
          $("#returnresult").html(returnresult);

          if ($(".empty-text").length > 0) {
            $(".empty-text").each(function () {
              $(this).remove();
            });
          }

          if (res.results.length > 0) {
            $(".table-responsive").removeClass("hide");
            $("#cylindrical_chart").removeClass("hide");
            $(".prompt").each(function () {
              $(this).addClass("hide");
            });

            pagination(res.results); //渲染表格数据

            var countData = [];
            var wordData = [];
            res.results.slice(0, 5).forEach((item, index) => {
              countData.push(item.count);
              wordData.push(item.word);
            });

            var e = {
              chart: {
                height: 380,
                type: "bar",
                color: "",
                toolbar: {
                  show: !1,
                },
              },
              plotOptions: {
                bar: {
                  dataLabels: {
                    position: "top",
                  },
                  columnWidth: "15%",
                },
              },
              dataLabels: {
                enabled: true, //启用数据标签，即是否直接在图标上显示数据
                formatter: function (val) {
                  return val;
                },
                offsetY: -25,
                style: {
                  fontSize: "14px",
                  colors: ["#304758"],
                },
              },
              series: [
                {
                  name: "词频",
                  data: countData,
                },
              ],
              xaxis: {
                categories: wordData,
                position: "bottom",
                labels: {
                  style: {
                    colors: ["#000", "#ff5c75"],
                    // offsetY: 18,

                    fontSize: "13px",
                    fontWeight: 500,
                  },
                },
                axisBorder: {
                  show: !1,
                },
                axisTicks: {
                  show: !1,
                },
                crosshairs: {
                  fill: {
                    type: "gradient",
                    gradient: {
                      colorFrom: "#D8E3F0",
                      colorTo: "#BED1E6",
                      stops: [0, 100],
                      opacityFrom: 0.4,
                      opacityTo: 0.5,
                    },
                  },
                },
                tooltip: {
                  enabled: !0,
                  offsetY: -35,
                },
              },
              fill: {
                gradient: {
                  enabled: !1,
                  shade: "light",
                  type: "horizontal",
                  shadeIntensity: 0.25,
                  gradientToColors: void 0,
                  inverseColors: !0,
                  opacityFrom: 1,
                  opacityTo: 1,
                  stops: [50, 0, 100, 100],
                  colors: ["#F44336", "#E91E63", "#9C27B0"],
                },
              },
              yaxis: {
                axisBorder: {
                  show: !1,
                },
                axisTicks: {
                  show: !1,
                },
                labels: {
                  show: !1,
                  formatter: function (e) {
                    return e;
                  },
                },
              },
              title: {
                text: "",
                floating: !0,
                offsetY: 5,
                align: "top",
                style: {
                  color: "#444",
                  fontSize: "20px",
                  fontWeight: "500",
                },
              },
              grid: {
                row: {
                  colors: ["transparent", "transparent"],
                  opacity: 0.2,
                  fontSize: "18px",
                  fontWeight: 700,
                },
                borderColor: "#f1f3fa",
                yaxis: {
                  lines: {
                    show: false,
                  },
                },
              },
            };
            document.querySelector("#cylindrical_chart").innerHTML = "";
            new ApexCharts(
              document.querySelector("#cylindrical_chart"),
              e
            ).render();
          } else {
            $(".prompt").each(function () {
              $(this)
                .find(".card-body")
                .append(
                  `<div class="empty-text">返回结果为空，换段文本再试试吧</div>`
                );
            });
            $(".table-responsive").addClass("hide");
            $("#cylindrical_chart").addClass("hide");
            $(".prompt").each(function () {
              $(this).removeClass("hide");
            });
          }
        }
      },
    });
  } else {
    $(".message-error .message_content").html("请输入要识别的内容");
    $(".message-error").removeClass("message-hide");
    setTimeout(() => {
      $(".message-error").addClass("message-hide");
    }, 2000);
  }
});
